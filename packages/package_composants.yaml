sun:
yeelight:
    devices:
      192.168.1.170:
        name: Vestibule
      192.168.1.171:
        name: Salledebain
      192.168.1.172:
        name: Chambre
      192.168.1.173:
        name: Vinyles Strip
      192.168.1.174:
        name: Bureau Strip
mqtt:  
  broker: localhost
  port: 1883
  username: !secret mqtt_login_junglenas
  password: !secret mqtt_password_junglenas
device_tracker:
  - platform: ddwrt
    host: !secret ddwrt_ip
    username: admin 
    password: !secret router_password
    interval_seconds: 10
    new_device_defaults:
      track_new_devices: False
ifttt:
  key: !secret ifttt_webhooks_key
sensor:
  - platform: command_line
    name: "Download Grafana - temps"
    command: !secret cmd_get_grafana_conso
  - platform: command_line
    name: "Download Grafana - conso"
    command: !secret cmd_get_grafana_temp
#  - platform: haveibeenpwned
#    email: 
#      - !secret email_1
#      - !secret email_2
  - platform: mqtt_room
    device_id: !secret junglenut_id
    state_topic: "room_presence"
    name: 'JungleNUT'
    timeout: 5
    away_timeout: 60
  - platform: worldclock
    time_zone: Europe/Paris
    name: France
  - platform: worldclock
    time_zone: Europe/Helsinki
    name: Finlande
  - platform: worldclock
    time_zone: Europe/Istanbul
    name: Turquie
  - platform: cpuspeed
  - platform: yr
    monitored_conditions:
      - symbol
      - temperature
      - precipitation
      - windSpeed
      - windDirection
      - humidity
      - cloudiness
  - platform: moon
  - platform: time_date
    display_options:
      - 'time'
      - 'date'
  - platform: history_stats
    name: Radiateur Chambre ON today
    entity_id: switch.radiateur_chambre
    state: 'on'
    type: time
    start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
    end: '{{ now() }}'
  - platform: history_stats
    name: Radiateur lit ON today
    entity_id: switch.sonoff_bed
    state: 'on'
    type: time
    start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
    end: '{{ now() }}'
  - platform: history_stats
    name: Radiateur Salon ON today
    entity_id: switch.radiateur_salon
    state: 'on'
    type: time
    start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
    end: '{{ now() }}'
  - platform: template
    sensors:
      radiateur_chambre_on_today_view:
        unit_of_measurement: 'Heures'
        value_template: '{{ states.sensor.radiateur_chambre_on_today.state }}'
      radiateur_lit_on_today_view:
        unit_of_measurement: 'Heures'
        value_template: '{{ states.sensor.radiateur_lit_on_today.state }}'
      radiateur_salon_on_today_view:
        unit_of_measurement: 'Heures'
        value_template: '{{ states.sensor.radiateur_salon_on_today.state }}' 
xiaomi_aqara:
  discovery_retry: 5
  gateways:
    - mac: !secret xiaomi_gateway_mac
      key: !secret xiaomi_gateway_key
      host: !secret xiaomi_gateway_ip
notify:
  - name: pushbullet_3t
    platform: pushbullet
    api_key: !secret pushbullet_api
  - name: gmail_smtp
    platform: smtp
    server: smtp.gmail.com
    port: 587
    timeout: 15
    sender: !secret gmail_user
    starttls: 1
    username: !secret gmail_user
    password: !secret gmail_pass
    recipient: !secret gmail_user
binary_sensor:
  - platform: trend
    sensors:
      gmail_new:
        entity_id: sensor.gmail_imap
switch:
  - platform: command_line
    switches:
      portail:
       command_on: !secret portail_trigger
       command_off: !secret portail_trigger
       friendly_name: Portail des terrasses
scene:
  - platform: lifx_cloud
    token: !secret lifxapitoken
script:
  scene_chambre_on:
    sequence:
      - service: light.turn_on
        data:
          entity_id: light.chambre
          transition: 60
  scene_cuisine_off:
    sequence:
      - service: light.turn_off
        data:
          entity_id: light.cuisine_2
          transition: 10
  scene_vestibule_off:
    sequence:
      - service: light.turn_off
        data:
          entity_id: light.vestibule
          transition: 10
influxdb:
  host: localhost
  include:
    entities:
      - sensor.temperature_158d0001f52004
      - sensor.multisens_sdb_temperature
      - sensor.temperature_158d0002273c15
      - sensor.releve_consommation_wh
      - sensor.temperature_158d0002272ffb
      - sensor.humidity_158d0002272ffb
      - sensor.temperature_158d00036c18d1
      - sensor.humidity_158d00036c18d1
      - sensor.ws_temperature_moyenne
      - sensor.ws_humidite_moyenne
      - sensor.ws_temperature_moyenne_espflora
      - sensor.ws_humidite_moyenne_espflora
#      - sensor.temperature_num_1
#      - sensor.humidite_num_1
#      - sensor.luminosite_num_1
#      - sensor.conductivite_num_1
#      - sensor.temperature_num_2
#      - sensor.humidite_num_2
#      - sensor.luminosite_num_2
#      - sensor.conductivite_num_2
      - sensor.humidity_158d0002273c15
      - sensor.humidity_158d0001f52004
      - sensor.multisens_sdb_humidity
camera:
  - platform: local_file
    name: Grafana_temperature
    file_path: !secret  grafana_path_temp
  - platform: local_file
    name: Grafana_conso
    file_path: !secret  grafana_path_conso
meteo_france:
  - city: !secret city_name
#    monitored_conditions:
#      - temperature
#      - weather
#      - wind_speed
#      - uv
#      - next_rain
#      - freeze_chance
#      - rain_chance
#      - snow_chance
#      - thunder_chance
#deconz:
#  host: !secret junglenas_ip
#  port: !secret deconz_port
